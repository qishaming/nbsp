(function(){function a(g,d,h){for(var f=0;f<h.length;f++){if(h[f][g]==d){return h[f].children}}}var b=[{id:3106,name:"国内",children:[{id:2,name:"安徽"},{id:3,name:"北京"},{id:4,name:"福建"},{id:5,name:"甘肃"},{id:6,name:"广东"},{id:7,name:"广西"},{id:8,name:"贵州"},{id:9,name:"海南"},{id:10,name:"河北"},{id:11,name:"河南"},{id:12,name:"黑龙江"},{id:13,name:"湖北"},{id:14,name:"湖南"},{id:15,name:"吉林"},{id:16,name:"江苏"},{id:17,name:"江西"},{id:18,name:"辽宁"},{id:19,name:"内蒙古"},{id:20,name:"宁夏"},{id:21,name:"青海"},{id:22,name:"山东"},{id:23,name:"山西"},{id:24,name:"陕西"},{id:25,name:"上海"},{id:26,name:"四川"},{id:27,name:"天津"},{id:28,name:"西藏"},{id:29,name:"新疆"},{id:30,name:"云南"},{id:31,name:"浙江"},{id:32,name:"重庆"},{id:33,name:"香港"},{id:34,name:"澳门"},{id:35,name:"台湾"}]}],c=function(d,f){this.data=[],this.elem=[],this.firstTxt=[],this.ajaxData=[],this.onchange=[];for(var e=0;e<d.length;e++){this.data[e]=d[e].data,this.elem[e]=fish.dom(d[e].query),this.firstTxt[e]=d[e].firstTxt,this.ajaxData[e]=d[e].ajaxData,this.onchange[e]=d[e].onchange}return this.allData=b,this.init(),this};c.prototype={init:function(){this.setFirstTxt();for(var d=0;d<this.elem.length;d++){typeof this.data[d]=="number"&&(this.data[d]=a("id",this.data[d],this.allData)),this.data[d]&&this.bulid(d)}this.bindElem()},setFirstTxt:function(){for(var d=0;d<this.elem.length;d++){this.removeSele(d),this.elem[d].options[0]=new Option(this.firstTxt[d])}},setData:function(f,d){this.data[d]=f,this.bulid(d)},bindElem:function(){var d=this;for(var f=0;f<this.elem.length;f++){(function(e){fish.one(d.elem[e]).on("change",function(){var h;this.selectedIndex>0&&(h=a("id",this.options[this.selectedIndex].getAttribute("_id"),d.data[e])),d.onchange[e]&&d.onchange[e](this,this.selectedIndex);if(h){d.elem[e+1]&&(d.data[e+1]=h,d.bulid(e+1))}else{if(d.ajaxData[e+1]&&d.elem[e].selectedIndex!=0){var g;d.ajaxData&&(g=d.ajaxData[e+1](this.options[this.selectedIndex].getAttribute("_id"))),fish.ajax({cache:!0,type:"jsonp",url:g,fn:function(j){j&&j.result&&d.setData(j.result,e+1)}})}}})})(f)}},removeSele:function(g){var d=this.elem[g].length,h=this.elem[g];for(var f=d-1;f>=0;f--){h.options[f]=null}},bulid:function(k,g){if(this.data[k]){this.removeSele(k);var m=this.data[k].length,j=this.elem[k],h=this.data[k],l=!0;if(this.firstTxt[k]!==null){var f=new Option(this.firstTxt[k],this.firstTxt[k]);f.setAttribute("_id",0);try{j.add(f,null)}catch(d){j.add(f)}j.selectedIndex=0}g&&g.only&&(l=!1);for(i=0;i<m;i++){if(h[i].name!=="0"&&l||!l&&h[i].name===g.only){var f=new Option(h[i].name,h[i].name);f.setAttribute("_id",h[i].id);try{j.add(f,null)}catch(d){j.add(f)}}}this.bulid(k+1)}}},fish.extend({mCitySelect:function(h,f){window.mIsLY=window.location.host.indexOf(".ly.com")>-1?!0:!1;var g=[];h.province&&g.push({query:h.province,firstTxt:h.provinceFirstText?h.provinceFirstText:"请选择省",data:3106}),h.city&&g.push({query:h.city,firstTxt:h.cityFirstText?h.cityFirstText:"请选择市",ajaxData:h.cityAjaxUrl?h.cityAjaxUrl:function(j){return"http://www."+(mIsLY?"ly.com":"17u.cn")+"/hotel/ajax/HotelAjaxCall.aspx?action=GetCityByProvince&id="+j}}),h.area&&g.push({query:h.area,firstTxt:h.areaFirstText?h.areaFirstText:"请选择区/县",ajaxData:h.areaAjaxUrl?h.areaAjaxUrl:function(j){return"http://www."+(mIsLY?"ly.com":"17u.cn")+"/hotel/ajax/HotelAjaxCall.aspx?action=GetAreaByCity&id="+j}});var d=new c(g);return f&&f(d),d}})})();
